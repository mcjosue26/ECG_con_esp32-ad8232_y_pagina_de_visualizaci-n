<!doctype html>
<html lang="es">
<head>
  <script src="./plotly.min.js"></script>
  <meta charset="UTF-8">
	<title>MidZooECG</title>
	<link rel="stylesheet" href="estilos.css">
</head>
<body>
  <br><br><br><br>
<h1>
    <p style="color: white;">
        Electrocardiograma
    </p>
</h1>
<br>
<div id="chart"></div>
<script src="/socket.io/socket.io.js" charset="utf-8"></script>
<script>
  var socket = io.connect('34.125.28.185:5001', {'forceNew':true});
  dat = 0;
  socket.on('desde_servidor', function(data) {
    console.log(data);
    dat = data;
  });

  function getData() {
  return Math.random();
  } 
  Plotly.newPlot('chart',[{
   // y:[dat],
    y:[getData()],
    type:'line'
  }]);

  var cnt = 0;

  setInterval(function(){
  Plotly.extendTraces('chart',{ y:[[getData()]]}, [0]);
  cnt++;
  if(cnt > 0) {
    Plotly.relayout('chart',{
      xaxis: {
      range: [cnt-500,cnt]
      }
    });
  }
  },15);
</script>

<header class="header">
  <div class="container">
  <div class="btn-menu">
    <label for="btn-menu">☰</label>
  </div>
    <div class="logo">
      <h1>Menú</h1>
    </div>
    <nav class="menu">
      <a href="./index.html">Inicio</a>
      <a href="./contacto.html">Contacto</a>
      <a href="#" id="logout">Salir</a>
    </nav>
  </div>
</header>
<div class="capa"></div>
<!--	--------------->
<input type="checkbox" id="btn-menu">
<div class="container-menu">
<div class="cont-menu">
  <nav>
    <a href="./ECG.html">ECG</a>
	  <a href="./hardware.html">Hardware</a>
  </nav>
  <label for="btn-menu">✖️</label>
</div>
</div>


</body>

<script type="module">
  // Import the functions from the SDK
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
  import { getDatabase, set, ref, update } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";

  // App Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyAd92cJFRsu90p4BgqhqiXZYHo7EzzlC50",
    authDomain: "midzooecg.firebaseapp.com",
    databaseURL: "https://midzooecg-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "midzooecg",
    storageBucket: "midzooecg.appspot.com",
    messagingSenderId: "175107107214",
    appId: "1:175107107214:web:8be329550d1a9658d81cdf"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);
  const auth = getAuth();

const btnSalir = document.getElementById("logout");

btnSalir.addEventListener('click', (e) => {
      e.preventDefault()
      signOut(auth).then(() => {
        }).catch((error) =>{
          const errorCode = error.code;
          const errorMessage = error.message;
          //alert(errorMessage);
        });
  })


onAuthStateChanged(auth, (user) => {
if (user) {
  // User is signed in
  const uid = user.uid;
} else {
  // User is signed out
  alert("No ha iniciado sesión");
  location.href = "../index.html";
}
});
</script>

</html>